# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ SQL –º–∏–≥—Ä–∞—Ü–∏–π

## ‚ö†Ô∏è –í–ê–ñ–ù–û

Supabase –≤ Figma Make **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ SQL —á–µ—Ä–µ–∑ API –ø–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–ü–æ—ç—Ç–æ–º—É –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å **–í–†–£–ß–ù–£–Æ** –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –Ω–∏–∂–µ.

---

## ‚úÖ –°–ü–û–°–û–ë 1: –ß–µ—Ä–µ–∑ Supabase Dashboard (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –ª—é–±–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∏—á–µ–≥–æ
- ‚úÖ –ó–∞–π–º—ë—Ç 2 –º–∏–Ω—É—Ç—ã

### **–®–∞–≥–∏**:

#### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
```
https://supabase.com/dashboard/project/YOUR_PROJECT_ID
```

#### 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ SQL Editor
- –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **"SQL Editor"**
- –ù–∞–∂–º–∏—Ç–µ **"New query"**

#### 3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é 001
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `/supabase/migrations/001_initial_schema.sql` –≤ –≤–∞—à–µ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
- **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ** (Ctrl+A, Ctrl+C)
- **–í—Å—Ç–∞–≤—å—Ç–µ** –≤ SQL Editor (Ctrl+V)
- –ù–∞–∂–º–∏—Ç–µ **"Run"** (–∏–ª–∏ Ctrl+Enter)
- –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (~10-30 —Å–µ–∫—É–Ω–¥)

#### 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é 002
- –ù–∞–∂–º–∏—Ç–µ **"New query"** (—Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å)
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `/supabase/migrations/002_row_level_security.sql`
- **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**
- **–í—Å—Ç–∞–≤—å—Ç–µ** –≤ SQL Editor
- –ù–∞–∂–º–∏—Ç–µ **"Run"**
- –î–æ–∂–¥–∏—Ç–µ—Å—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"Table Editor"** (–ª–µ–≤–æ–µ –º–µ–Ω—é)
- –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å **8 –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü**:
  - artists
  - concerts
  - notifications
  - notification_settings
  - email_campaigns
  - ticket_providers
  - artist_ticket_providers
  - ticket_sales

---

## ‚úÖ –°–ü–û–°–û–ë 2: –ß–µ—Ä–µ–∑ Supabase CLI

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π –º–∏–≥—Ä–∞—Ü–∏–π
- ‚úÖ –î–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤

### **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- Node.js —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –î–æ—Å—Ç—É–ø –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É

### **–®–∞–≥–∏**:

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Supabase CLI
```bash
npm install -g supabase
```

#### 2. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å
```bash
supabase login
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä - –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å.

#### 3. –°–≤—è–∂–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
```bash
# –ù–∞–π–¥–∏—Ç–µ YOUR_PROJECT_REF –≤ Dashboard ‚Üí Settings ‚Üí General ‚Üí Reference ID
supabase link --project-ref YOUR_PROJECT_REF
```

#### 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
supabase db push
```

–ì–æ—Ç–æ–≤–æ! CLI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç —Ñ–∞–π–ª—ã –≤ `/supabase/migrations/` –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç –∏—Ö.

#### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
```bash
supabase db status
```

---

## ‚úÖ –°–ü–û–°–û–ë 3: –ß–µ—Ä–µ–∑ Postgres –∫–ª–∏–µ–Ω—Ç (–¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö)

### **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- psql –∏–ª–∏ –ª—é–±–æ–π Postgres –∫–ª–∏–µ–Ω—Ç
- Connection string –∏–∑ Dashboard

### **–®–∞–≥–∏**:

#### 1. –ü–æ–ª—É—á–∏—Ç–µ Connection String
- Dashboard ‚Üí Settings ‚Üí Database ‚Üí Connection string
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ "Connection string"

#### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å —á–µ—Ä–µ–∑ psql
```bash
psql "postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres"
```

#### 3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```sql
\i /path/to/supabase/migrations/001_initial_schema.sql
\i /path/to/supabase/migrations/002_row_level_security.sql
```

---

## üß™ –ü–†–û–í–ï–†–ö–ê –ü–û–°–õ–ï –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø

### **1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ SQL**:

–í SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
ORDER BY table_name;
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 8+ —Ç–∞–±–ª–∏—Ü.

### **2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç**:

```sql
-- –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ü–µ—Ä—Ç
INSERT INTO concerts (
  artist_id, title, city, venue_name,
  event_date, event_time, event_type
) VALUES (
  gen_random_uuid(), '–¢–µ—Å—Ç', '–ú–æ—Å–∫–≤–∞', '–ö–ª—É–±',
  '2026-03-01', '20:00', '–ö–æ–Ω—Ü–µ—Ä—Ç'
);

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ created_at –∏ updated_at —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å
SELECT title, created_at, updated_at 
FROM concerts 
ORDER BY created_at DESC 
LIMIT 1;
```

### **3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –≤–∫–ª—é—á—ë–Ω**:

```sql
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE schemaname = 'public';
```

–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å `rowsecurity = true`.

### **4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –±–∏–ª–µ—Ç–æ–≤**:

```sql
SELECT * FROM ticket_providers;
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å 4 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (–ö–∞—Å—Å–∏—Ä.—Ä—É, Ticketland, –Ø–Ω–¥–µ–∫—Å –ê—Ñ–∏—à–∞, TicketMaster).

---

## üîÑ –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ù–ê SQL MODE (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –Ω–∞ PostgreSQL:

### **1. –û—Ç–∫—Ä–æ–π—Ç–µ Edge Functions Settings**:
- Dashboard ‚Üí Edge Functions
- –í—ã–±–µ—Ä–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `make-server-84730125`
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Environment Variables**

### **2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é**:
```
Key: STORAGE_MODE
Value: sql
```

### **3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ**

–§—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∏ –Ω–∞—á–Ω—ë—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –≤–º–µ—Å—Ç–æ KV Store!

---

## ‚ùå –û–¢–ö–ê–¢ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ –∏ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### **–ß–µ—Ä–µ–∑ SQL Editor**:

```sql
-- –û–°–¢–û–†–û–ñ–ù–û: –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã!

DROP TABLE IF EXISTS ticket_sales CASCADE;
DROP TABLE IF EXISTS artist_ticket_providers CASCADE;
DROP TABLE IF EXISTS ticket_providers CASCADE;
DROP TABLE IF EXISTS email_campaigns CASCADE;
DROP TABLE IF EXISTS notification_settings CASCADE;
DROP TABLE IF EXISTS notifications CASCADE;
DROP TABLE IF EXISTS concerts CASCADE;
DROP TABLE IF EXISTS artists CASCADE;

DROP FUNCTION IF EXISTS increment_concert_views;
DROP FUNCTION IF EXISTS increment_concert_clicks;
DROP FUNCTION IF EXISTS calculate_campaign_metrics;
DROP FUNCTION IF EXISTS update_updated_at_column;
DROP FUNCTION IF EXISTS is_artist_owner;
DROP FUNCTION IF EXISTS is_concert_owner;
```

---

## üÜò –ß–ê–°–¢–´–ï –û–®–ò–ë–ö–ò

### **–û—à–∏–±–∫–∞: "permission denied"**
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –≤–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Service Role Key.

### **–û—à–∏–±–∫–∞: "relation already exists"**
**–†–µ—à–µ–Ω–∏–µ**: –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ.

### **–û—à–∏–±–∫–∞: "syntax error near..."**
**–†–µ—à–µ–Ω–∏–µ**: 
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏—Å—å –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫

### **–û—à–∏–±–∫–∞: "could not connect"**
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –Ω–µ –∑–∞–º–æ—Ä–æ–∂–µ–Ω (Dashboard ‚Üí Settings ‚Üí General).

---

## üìã CHECKLIST

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:

- [ ] 8 —Ç–∞–±–ª–∏—Ü —Å–æ–∑–¥–∞–Ω—ã
- [ ] 4 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –±–∏–ª–µ—Ç–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] –¢—Ä–∏–≥–≥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç (updated_at –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
- [ ] RLS –≤–∫–ª—é—á—ë–Ω –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- [ ] –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã (increment_*, calculate_*, etc)
- [ ] –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π —É –≤–∞—Å –±—É–¥–µ—Ç:

‚úÖ **8 —Ç–∞–±–ª–∏—Ü** —Å –ø–æ–ª–Ω–æ–π —Å—Ö–µ–º–æ–π
‚úÖ **20+ RLS –ø–æ–ª–∏—Ç–∏–∫** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏  
‚úÖ **20+ –∏–Ω–¥–µ–∫—Å–æ–≤** –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚úÖ **4 SQL —Ñ—É–Ω–∫—Ü–∏–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚úÖ **–¢—Ä–∏–≥–≥–µ—Ä—ã** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è timestamps
‚úÖ **4 –±–∏–ª–µ—Ç–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞** –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

**–í—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è**: 2-5 –º–∏–Ω—É—Ç

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ `STORAGE_MODE=sql` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è PostgreSQL!

---

**–î–∞—Ç–∞**: 26 —è–Ω–≤–∞—Ä—è 2026
**–í–µ—Ä—Å–∏—è**: 4.0.0
**–°—Ç–∞—Ç—É—Å**: –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é
